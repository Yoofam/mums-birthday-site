<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Happy Birthday, Mum!</title>
  <style>
    :root{--accent:#d63384;--bg:#fff6f9;--card:#ffffff}
    *{box-sizing:border-box}
    body{margin:0;font-family:Inter,system-ui,Segoe UI,Roboto,Helvetica,Arial; background:linear-gradient(180deg,#fff6f9 0%, #fff 60%);color:#222}
    header{padding:48px 20px;text-align:center}
    h1{font-size: clamp(28px,5vw,48px);margin:0 0 8px;color:var(--accent)}
    p.lead{margin:0 0 16px;font-size:18px;opacity:.85}
    .card{max-width:980px;margin:20px auto;padding:20px;border-radius:16px;background:var(--card);box-shadow:0 6px 30px rgba(0,0,0,.08)}
    .controls{display:flex;gap:12px;flex-wrap:wrap;justify-content:center;align-items:center}
    button{padding:10px 16px;border-radius:10px;border:0;background:var(--accent);color:white;font-weight:600;cursor:pointer}
    .countdown{font-weight:700;font-size:20px}
    /* gallery */
    .gallery{display:grid;grid-template-columns:repeat(auto-fit,minmax(140px,1fr));gap:12px;margin-top:18px}
    .gallery img{width:100%;height:140px;object-fit:cover;border-radius:10px;cursor:pointer;display:block}
    /* modal lightbox */
    .lightbox{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(0,0,0,.6);z-index:40}
    .lightbox.open{display:flex}
    .lightbox img{max-width:92%;max-height:80%;border-radius:8px}
    .close{position:absolute;top:20px;right:20px;background:#fff;padding:8px;border-radius:50%;cursor:pointer}
    footer{padding:20px;text-align:center;color:#666;font-size:13px}
    /* confetti canvas */
    canvas#confetti{position:fixed;pointer-events:none;top:0;left:0;right:0;bottom:0;z-index:50}
    @media (prefers-reduced-motion:reduce){*{animation:none!important}}
  </style>
</head>
<body>
  <canvas id="confetti"></canvas>
  <header>
    <h1>Happy Birthday, Mum! üéâ</h1>
    <p class="lead">A little page made with love ‚Äî pictures, music, confetti and a countdown to September 25th.</p>
  </header>

  <div class="card">
    <div style="text-align:center">
      <div class="controls">
        <button id="playPause">Play Birthday Song ‚ñ∂</button>
        <div class="countdown" id="countdown">Loading countdown‚Ä¶</div>
        <button id="celebrate">Celebrate üéä</button>
      </div>
    </div>

    <hr style="margin:18px 0;border:none;border-top:1px solid #f0e7ef">

    <h3 style="margin:0 0 8px">Photo Gallery</h3>
    <p style="margin:0 0 12px;opacity:.8">Click a photo to view it larger.</p>

    <div id="gallery" class="gallery"></div>
  </div>

  <div id="lightbox" class="lightbox" role="dialog" aria-hidden="true">
    <button class="close" id="lightboxClose">‚úï</button>
    <img id="lightboxImg" alt="Enlarged photo" src=""/>
  </div>

  <footer class="card" style="max-width:980px;margin:12px auto 40px">Made with ‚ù§Ô∏è ‚Äî Enjoy the day!</footer>

  <audio id="bdayAudio" src="choir.mp3" preload="auto"></audio>

  <script>
    // Load gallery from manifest.json (generated when packaging the site)
    async function loadGallery(){
      try{
        const res = await fetch('images/manifest.json');
        const imgs = await res.json();
        const gallery = document.getElementById('gallery');
        imgs.forEach(fn=>{
          const img = document.createElement('img');
          img.src = 'images/'+fn;
          img.alt = fn;
          img.loading = 'lazy';
          img.addEventListener('click', ()=>openLightbox(img.src));
          gallery.appendChild(img);
        });
      }catch(e){
        document.getElementById('gallery').innerHTML = '<p style="opacity:.8">No images found. Be sure images/manifest.json is present.</p>'
      }
    }

    // Lightbox
    const lb = document.getElementById('lightbox');
    const lbImg = document.getElementById('lightboxImg');
    document.getElementById('lightboxClose').addEventListener('click', closeLightbox);
    lb.addEventListener('click', (e)=>{ if(e.target===lb) closeLightbox(); });
    function openLightbox(src){ lbImg.src = src; lb.classList.add('open'); lb.setAttribute('aria-hidden','false'); }
    function closeLightbox(){ lb.classList.remove('open'); lb.setAttribute('aria-hidden','true'); lbImg.src=''; }

    // Audio play/pause
    const audio = document.getElementById('bdayAudio');
    const btn = document.getElementById('playPause');
    let isPlaying = false;
    btn.addEventListener('click', ()=>{
      if(!isPlaying){ audio.play(); btn.textContent = 'Pause Birthday Song ‚è∏'; isPlaying=true; }
      else { audio.pause(); btn.textContent = 'Play Birthday Song ‚ñ∂'; isPlaying=false; }
    });

    // Countdown to next Sep 25
    function getNextBirthday(){
      const now = new Date();
      const year = now.getFullYear();
      let target = new Date(`${year}-09-25T00:00:00`);
      if(now > target) target = new Date(`${year+1}-09-25T00:00:00`);
      return target;
    }
    const countdownEl = document.getElementById('countdown');
    function updateCountdown(){
      const now = new Date();
      const diff = getNextBirthday() - now;
      if(diff<=0){ countdownEl.textContent = 'Happy Birthday! üéâ'; clearInterval(cdInterval); return; }
      const days = Math.floor(diff/86400000);
      const hours = Math.floor((diff%86400000)/3600000);
      const mins = Math.floor((diff%3600000)/60000);
      const secs = Math.floor((diff%60000)/1000);
      countdownEl.textContent = `${days}d ${hours}h ${mins}m ${secs}s`;
    }
    const cdInterval = setInterval(updateCountdown,1000);
    updateCountdown();

    // Confetti (simple canvas particle confetti)
    (function(){
      const canvas = document.getElementById('confetti');
      const ctx = canvas.getContext('2d');
      let W = canvas.width = innerWidth;
      let H = canvas.height = innerHeight;
      window.addEventListener('resize', ()=>{ W=canvas.width=innerWidth; H=canvas.height=innerHeight; });

      function random(min,max){ return Math.random()*(max-min)+min }
      class Confetto{ constructor(){ this.x = random(0,W); this.y = random(-H,-10); this.size = random(6,14); this.speed = random(1,6); this.tilt = random(-10,10); this.color = `hsl(${~~random(0,360)},80%,60%)`; this.rotation = random(0,360); }
        update(){ this.y += this.speed; this.x += Math.sin(this.y/20); this.rotation += 4; if(this.y>H+20) this.y = random(-H,-10); }
        draw(){ ctx.save(); ctx.translate(this.x,this.y); ctx.rotate(this.rotation*Math.PI/180); ctx.fillStyle=this.color; ctx.fillRect(-this.size/2, -this.size/2, this.size, this.size*0.6); ctx.restore(); }
      }
      const confetti = [];
      function launch(n=80){ for(let i=0;i<n;i++) confetti.push(new Confetto()); }
      function frame(){ ctx.clearRect(0,0,W,H); confetti.forEach(c=>{ c.update(); c.draw(); }); requestAnimationFrame(frame); }
      frame();
      document.getElementById('celebrate').addEventListener('click', ()=>{ launch(120); });
    })();

    // Init
    loadGallery();
  </script>
</body>
</html>
